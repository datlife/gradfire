select term_year, term_month, subject, number, count(*) as instructor_count from (select distinct on (term_year, term_month, subject, number, instructor_id) term_year, term_month, subject, number from courses group by term_month, term_year, subject, number, instructor_id order by term_year, term_month, subject, number) as q group by q.term_year, q.term_month, q.subject, q.number ORDER BY instructor_count DESC;
